
uC/OS-II @251_Xsmall+Large  PendSv切换任务  移植版  tzz1983

迎接STC8051U新生, uC/OS-II @251_Xsmall+Large版, 对小尺寸edata的型号支持力度加大. 2K edata 多任务轻松运行


简介： 用于 STC MUC 251内核上的 uC/OS-2.93 移植版本.
*支持 xsmall 和 large  两种编译模式
*支持 指定OS全局变量存放于 xdata 或 edata. 不受编译模式影响.
*支持 MSP+PSP 模式, 可大量节省edata的使用量.
*支持 不受OS管理的中断选项.


测试：例程已包含并通过了 "计数信号量,消息邮箱,标志集,邮箱队列,互斥信号量,内存管理,软件定时器,
任务上锁/解锁,任务挂起/解挂,获取OS时间,统计任务,堆栈检查,"  的简单功能测试.


使用需知：
1.勾选 项目编译选项全局重入 "Generate reentrant functions",选项.
2.局部变量不要显式指定存储类型,让编译器自动决定.
3.调度器开启前不要打开EA, 启用调度器时会自动打开EA.
4.定时器0已用作系统滴答,最低昙. 默认Time4用作PendSv中断, PendSv中断可更改为其它中断源.
5.请使用本项目中的START251.A51, 针对OS移植有增设语句(第236行). 
6.START251.A51 中的 STACKSIZE (第109行) 被用作中断专用栈的大小, 一般来说： STACKSIZE >= (64*放开了多少个中断优先级)


配制时钟源：	请转到  config.h
配制PendSv：	请转至　os_cfg.h  os_cpu_c.c
配制中断：	请转至　os_cfg.h
配制OS全局变量存放位置  宏指定OS全局变量存放于 xdata或 edata, 此选项不受编译模式的影响. (os_cfg.h) 



为了节省内存开支,注销了任务控制块TCB结构中不常用的几个数据成员, 如果需要使用对应功能, 全局搜变量名, 取消对应的注销即可

//    void            *OSTCBExtPtr;           /* 扩展数据用的备用指针  */
//    INT32U           OSTCBCtxSwCtr;         /* 任务切换次数 */
//    INT32U           OSTCBCyclesTot;        /* 任务已运行的总时钟周期数  */
//    INT32U           OSTCBCyclesStart;      /* 任务恢复开始时的循环计数器快照  */
//    OS_STK          *OSTCBStkBase;          /* 任务堆栈基址      */     

