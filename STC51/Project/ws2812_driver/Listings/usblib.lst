C251 COMPILER V5.60.0,  usblib                                                             25/01/26  03:00:11  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE usblib
OBJECT MODULE PLACED IN .\Objects\usblib.obj
COMPILER INVOKED BY: S:\Embedded\Keil\C251\BIN\C251.EXE Sources\usblib.c XSMALL BROWSE INCDIR(.\Sources\inc;.\Sources\ap
                    -p;.\Sources\hal;.\Sources\fml;.\Sources\utils) DEBUG PRINT(.\Listings\usblib.lst) OBJECT(.\Objects\usblib.obj) 

stmt  level    source

    1          //<<AICUBE_USER_HEADER_REMARK_BEGIN>>
    2          ////////////////////////////////////////
    3          // 在此添加用户文件头说明信息  
    4          // 文件名称: usblib.c
    5          // 文件描述: 
    6          // 文件版本: V1.0
    7          // 修改记录:
    8          //   1. (2025-12-13) 创建文件
    9          ////////////////////////////////////////
   10          //<<AICUBE_USER_HEADER_REMARK_END>>
   11          
   12          
   13          #include "config.h"
   14          
   15          
   16          //<<AICUBE_USER_INCLUDE_BEGIN>>
   17          // 在此添加用户头文件包含  
   18          //<<AICUBE_USER_INCLUDE_END>>
   19          
   20          
   21          //<<AICUBE_USER_GLOBAL_DEFINE_BEGIN>>
   22          // 在此添加用户全局变量定义、用户宏定义以及函数声明  
   23          //<<AICUBE_USER_GLOBAL_DEFINE_END>>
   24          
   25          
   26          
   27          ////////////////////////////////////////
   28          // USB库初始化函数
   29          // 入口参数: 无
   30          // 函数返回: 无
   31          ////////////////////////////////////////
   32          void USBLIB_Init(void)
   33          {
   34   1          usb_init();                         //初始化USB模块
   35   1          USB_SetIntPriority(0);              //设置中断为最低优先级
   36   1          set_usb_OUT_callback(USBLIB_OUT_Callback); //设置USB中断回调函数
   37   1          set_usb_ispcmd("@STCISP#");         //设置USB不停电下载命令
   38   1      
   39   1          //<<AICUBE_USER_USBLIB_INITIAL_BEGIN>>
   40   1          // 在此添加用户初始化代码  
   41   1          //<<AICUBE_USER_USBLIB_INITIAL_END>>
   42   1      }
   43          
   44          ////////////////////////////////////////
   45          // 等待USB配置完成函数
   46          // 入口参数: 无
   47          // 函数返回: 无
   48          ////////////////////////////////////////
   49          void USBLIB_WaitConfiged(void)
   50          {
   51   1          while (DeviceState != DEVSTATE_CONFIGURED) //等待USB完成配置
   52   1              WDT_Clear();                    //清看门狗定时器 (防止硬件自动使能看门狗)
   53   1      }
   54          
   55          ////////////////////////////////////////
   56          // USB设备接收数据中断回调程序
   57          // 入口参数: 无
   58          // 函数返回: 无
C251 COMPILER V5.60.0,  usblib                                                             25/01/26  03:00:11  PAGE 2   

   59          // OutNumber：USB设备接收到的数据长度
   60          // UsbOutBuffer：保存USB设备接收到的数据
   61          ////////////////////////////////////////
   62          void USBLIB_OUT_Callback(void)
   63          {
   64   1          //<<AICUBE_USER_USBLIB_ISR_CODE1_BEGIN>>
   65   1          // 在此添加中断函数用户代码  
   66   1          USB_SendData(UsbOutBuffer, OutNumber); //原路返回, 用于测试
   67   1          // 在此处添加用户处理接收数据的代码
   68   1          //<<AICUBE_USER_USBLIB_ISR_CODE1_END>>
   69   1      }
   70          
   71          
   72          
   73          //<<AICUBE_USER_FUNCTION_IMPLEMENT_BEGIN>>
   74          // 在此添加用户函数实现代码  
   75          //<<AICUBE_USER_FUNCTION_IMPLEMENT_END>>
   76          
   77          


Module Information          Static   Overlayable
------------------------------------------------
  code size            =        57     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =         9     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
