C251 COMPILER V5.60.0,  timer                                                              25/01/26  03:00:11  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE timer
OBJECT MODULE PLACED IN .\Objects\timer.obj
COMPILER INVOKED BY: S:\Embedded\Keil\C251\BIN\C251.EXE Sources\timer.c XSMALL BROWSE INCDIR(.\Sources\inc;.\Sources\app
                    -;.\Sources\hal;.\Sources\fml;.\Sources\utils) DEBUG PRINT(.\Listings\timer.lst) OBJECT(.\Objects\timer.obj) 

stmt  level    source

    1          //<<AICUBE_USER_HEADER_REMARK_BEGIN>>
    2          ////////////////////////////////////////
    3          // 在此添加用户文件头说明信息  
    4          // 文件名称: timer.c
    5          // 文件描述: 定时器驱动，包含定时器0初始化和中断处理
    6          // 文件版本: V1.0
    7          // 修改记录:
    8          //   1. (2025-12-28) 创建文件
    9          ////////////////////////////////////////
   10          //<<AICUBE_USER_HEADER_REMARK_END>>
   11          
   12          
   13          #include "config.h"
   14          
   15          
   16          //<<AICUBE_USER_INCLUDE_BEGIN>>
   17          // 在此添加用户头文件包含  
   18          //<<AICUBE_USER_INCLUDE_END>>
   19          
   20          
   21          //<<AICUBE_USER_GLOBAL_DEFINE_BEGIN>>
   22          // 定时器中断计数
   23          static int timer0_count = 0;
   24          //<<AICUBE_USER_GLOBAL_DEFINE_END>>
   25          
   26          
   27          
   28          ////////////////////////////////////////
   29          // 定时器0初始化函数
   30          // 入口参数: 无
   31          // 函数返回: 无
   32          ////////////////////////////////////////
   33          void TIMER0_Init(void)
   34          {
   35   1      #define T0_PSCR                 (51)
   36   1      #define T0_RELOAD               (65536 - (float)SYSCLK / 12 / (T0_PSCR + 1) * 1 / 1) //定时周期1秒
   37   1      
   38   1          TIMER0_TimerMode();                 //设置定时器0为定时模式
   39   1          TIMER0_12TMode();                   //设置定时器0为12T模式
   40   1          TIMER0_Mode0();                     //设置定时器0为模式0 (16位自动重载模式)
   41   1          TIMER0_DisableGateINT0();           //禁止定时器0门控
   42   1          TIMER0_SetIntPriority(0);           //设置中断为最低优先级
   43   1          TIMER0_EnableInt();                 //使能定时器0中断
   44   1          TIMER0_SetPrescale(T0_PSCR);        //设置定时器0的8位预分频
   45   1          TIMER0_SetReload16(T0_RELOAD);      //设置定时器0的16位重载值
   46   1          TIMER0_Run();                       //定时器0开始运行
   47   1      
   48   1          //<<AICUBE_USER_TIMER0_INITIAL_BEGIN>>
   49   1          // 在此添加用户初始化代码  
   50   1          //<<AICUBE_USER_TIMER0_INITIAL_END>>
   51   1      }
   52          
   53          
   54          ////////////////////////////////////////
   55          // 定时器0中断服务程序
   56          // 入口参数: 无
   57          // 函数返回: 无
   58          ////////////////////////////////////////
C251 COMPILER V5.60.0,  timer                                                              25/01/26  03:00:11  PAGE 2   

   59          void TIMER0_ISR(void) interrupt TMR0_VECTOR
   60          {
   61   1          //<<AICUBE_USER_TIMER0_ISR_CODE1_BEGIN>>
   62   1          // 在此添加中断函数用户代码  
   63   1          //<<AICUBE_USER_TIMER0_ISR_CODE1_END>>
   64   1      }
   65          
   66          
   67          //<<AICUBE_USER_FUNCTION_IMPLEMENT_BEGIN>>
   68          // 在此添加用户函数实现代码  
   69          //<<AICUBE_USER_FUNCTION_IMPLEMENT_END>>
   70          
   71          


Module Information          Static   Overlayable
------------------------------------------------
  code size            =        45     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =         2     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =         6     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
